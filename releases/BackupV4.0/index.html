<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jellyfin Dateisortierung v3</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ğŸ“ Jellyfin Dateisortierung v3</h1>
    <p>Automatische Analyse und Sortierung von Mediendateien mit echtem Upload</p>
    <p style="font-size: 0.85rem; margin-top: 16px; opacity: 0.85;">
      ğŸ” Session: <span id="sessionDisplay" style="font-family: monospace; background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 4px;">â€“</span>
    </p>
  </header>

  <main>
    <!-- ===========================
         SCHRITT 1: UPLOAD
         =========================== -->
    <section id="uploadSection" class="panel">
      <h2>ğŸ“¤ Schritt 1: Dateien hochladen</h2>
      
      <!-- Drop Zone -->
      <div id="dropZone" class="drop-zone">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
        <p class="drop-zone-text">Dateien hier ablegen oder klicken</p>
        <p class="drop-zone-hint">Alle Videoformate unterstÃ¼tzt</p>
        <input type="file" id="fileInput" multiple hidden>
      </div>

      <!-- Upload Liste mit Progress -->
      <div id="uploadList" class="upload-list"></div>

      <!-- ğŸ“‹ Temp-Ordner Dateiliste mit Auswahl -->
      <div id="tempFileListContainer" style="display: none; margin-top: 20px;">
        <h3>ğŸ“‹ Dateien im Temp-Ordner</h3>
        
        <!-- Select All / Deselect All Buttons -->
        <div style="margin-bottom: 12px; display: flex; gap: 8px;">
          <button id="selectAllFilesBtn" class="btn-secondary" style="flex: 1;">
            âœ“ Alle auswÃ¤hlen
          </button>
          <button id="deselectAllFilesBtn" class="btn-secondary" style="flex: 1;">
            âœ— Alle abwÃ¤hlen
          </button>
        </div>

        <!-- Datei-Checkboxen -->
        <div id="tempFileList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; max-height: 400px; overflow-y: auto; padding: 12px; background: rgba(59,130,246,0.05); border-radius: 8px; border: 1px solid rgba(59,130,246,0.2);">
          <!-- Wird dynamisch befÃ¼llt -->
        </div>
      </div>

      <!-- Action Buttons fÃ¼r Upload-Sektion -->
      <div class="upload-actions">
        <button id="reloadTempBtn" class="btn-secondary" title="Temp-Ordner neuladen">
          ğŸ”„ Ordner neuladen
        </button>
        <button id="analyzeFilesBtn" class="btn-primary" disabled title="AusgewÃ¤hlte Dateien aus dem Temp-Ordner analysieren">
          â–¶ Dateien analysieren
        </button>
      </div>
    </section>

    <!-- ===========================
         SCHRITT 2: ANALYSE & BEARBEITUNG
         =========================== -->
    <section id="analysisSection" class="panel" style="display: none;">
      <h2>âœï¸ Schritt 2: Dateien kategorisieren & anpassen</h2>
      
      <!-- Kategorisierte Dateiliste -->
      <div id="categorizedList" class="categorized-list"></div>

      <!-- Action Buttons fÃ¼r Analyse-Sektion -->
      <div class="analysis-actions">
        <button id="backToUploadBtn" class="btn-secondary">
          â† ZurÃ¼ck zum Upload
        </button>
        <button id="finalizeBtn" class="btn-primary">
          âœ“ Fertigstellen
        </button>
      </div>
    </section>

    <!-- Debug Panel (nur sichtbar wenn aktiviert) -->
    <section id="debugPanel" class="panel debug-panel" style="display: none;">
      <h2>ğŸ› Debug Panel</h2>
      <div id="debugOutput" class="debug-output"></div>
      <button id="clearDebugBtn" class="btn-secondary">Debug lÃ¶schen</button>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
